<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="./img/favicon-octo.ico">
    <title>Which API Management is right for me ?</title>
    <link href="./css/bootstrap.css" rel="stylesheet">
    <link href="./css/open-iconic-bootstrap.css" rel="stylesheet">
    <link rel="stylesheet" href="./css/style.css">
</head>

<body>
<img id="bg" src=""/>

<header>

    <div class="d-flex flex-column flex-md-row align-items-center p-3 px-md-4 mb-3 bg-white border-bottom shadow-sm">
        <h5 id="logo" class="my-0 mr-md-auto font-weight-normal"><img src="./img/logo-octo.png">Which API Management is
            right for me ?</h5>
    </div>

</header>

<main role="main">

    <section class="container" id="section-start-quizz">
        <div class="row">
            <div class="col-md-3"></div>
            <div class="col-md-6">
                <div class="card start-quizz">
                    <div class="card-body">
                        <h1 class="card-title">WICH API MANAGEMENT?</h1>
                        <h2 class="card-title">START THE QUIZZ !</h2>
                        <img src="https://rejoins.octo.com/assets/home/internship-a595eba43b8bad6f7afd4708824248a3c9d5992ae6129498bd71cb7e28f789a3.svg">
                    </div>
                </div>
            </div>
            <div class="col-md-3"></div>
        </div>
    </section>

    <section class="container" id="section-quizz">
        <div class="row">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-body quizz">
                        <form id="what-dev-form" class="needs-validation">
                            <h1 class="mb-3">What kind of developers I have ?</h1>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="what-dev-radios"
                                       id="what-dev-radios-none" value="none">
                                <label class="form-check-label" for="what-dev-radios-none">
                                    None
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="what-dev-radios"
                                       id="what-dev-radios-dev" value="dev">
                                <label class="form-check-label" for="what-dev-radios-dev">
                                    I have developers
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="what-dev-radios"
                                       id="what-dev-radios-experts" value="experts">
                                <label class="form-check-label" for="what-dev-radios-experts">
                                    I have good or expert developers
                                </label>
                            </div>
                        </form>
                        <form id="T2M-custom-form" class="needs-validation">
                            <h1 class="mb-3">What are my time to market and customization needs</h1>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="T2M-custom-radios"
                                       id="T2M-custom-radios-fast-low" value="fast-low">
                                <label class="form-check-label" for="T2M-custom-radios-fast-low">
                                    FAST T2M LOW CUSTOMIZABLE
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="T2M-custom-radios"
                                       id="T2M-custom-radios-medium-medium" value="medium-medium">
                                <label class="form-check-label" for="T2M-custom-radios-medium-medium">
                                    MEDIUM T2M MEDIUM CUSTOMISABLE
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="T2M-custom-radios"
                                       id="T2M-custom-radios-slow-high" value="slow-high">
                                <label class="form-check-label" for="T2M-custom-radios-slow-high">
                                    SLOW T2M HIGHLY CUSTOMIZABLE
                                </label>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="container" id="section-solutions">
    </section>

</main>

<footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-3"><img src="./img/logo-octo.png"></div>
            <div class="col-md-6">
                <p>
                    Paris - Rabat - Lausanne - Sydney <br/>
                    ContactÂ© OCTO Technology 2019
                </p>
            </div>
            <div class="col-md-3"></div>
        </div>
    </div>
    </div>
</footer>

<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="./js/jquery-3.3.1.min.js"></script>
<script src="./js/bootstrap.js"></script>


<script>

    $(document).ready(function() {

        var OCTO_APIM_APP = OCTO_APIM_APP || {};

        OCTO_APIM_APP.app = {
            conf: null,
            init: function() {
                var self = this;
                $("section").hide();
                $("input[type=radio]").removeAttr('checked');
                console.log($("input[type=radio]"));

                $("#logo").click(function() {
                    app.init();
                });

                $("#section-start-quizz").click(function() {
                    $("#section-start-quizz").hide();
                    $("#section-quizz").fadeIn();
                });

                $("form").submit(function(e) {
                    e.preventDefault();
                });

                $("section").hide();
                $("#section-search-result").html("");
                $("#menu-search").addClass("btn-primary");
                $("#menu-create").removeClass("btn-primary");
                $("#what-dev-form").fadeIn();
                $("#section-start-quizz").fadeIn();

                //$("#bg").attr("src", "./img/octo-tribes.svg");
                $("#bg").attr("src", "./img/background.jpg");
                $("#bg").fadeIn(2000);

                // load json conf
                $.ajax({
                    url: "./conf/conf.json",
                    type: 'GET',
                    dataType: "json",
                    crossDomain: true,
                    cache: false,
                    success: function(data) {
                        self.conf = data;

                        // set question
                        var htmlquizz = self.generateFormBloc();
                        $("#section-quizz").html(htmlquizz);
                        $("input[type=radio]").click(function(e) {
                            e.preventDefault();
                            var current = $(this);
                            var ID = current.attr("id");
                            console.log("handler - cal click handler for id:" + current.attr("id"));
                            console.log("handler -  - question.type:"+self.conf.quizz[ID].type);
                            if(self.conf.quizz[ID].type == "leaf") {
                                console.log("handler - LEAF !");
                                var htmlapims = '<div class="row">';
                                var apims = self.conf.quizz[ID].apim;
                                for(var i = 0; i < apims.length; i++) {
                                    var apim = apims[i];
                                    console.log("handler - iterating APIM :" + apim);
                                    for(var j = 0; j < self.conf.vendorsolutions.length; j++) {
                                        if(apim==self.conf.vendorsolutions[j].id) {
                                            console.log("handler - adding APIM :" + apim);
                                            htmlapims += self.generateVendorSolutionBloc(self.conf.vendorsolutions[j]);
                                            if(i != 0 && (i + 1) % 3 === 0) {
                                                htmlapims += '</div>';
                                                htmlapims += '<div class="row">';
                                            }
                                        }
                                    }
                                }
                                htmlapims += '</div>';
                                $("form").hide();
                                $("#section-quizz").hide();
                                $("#section-solutions").html(htmlapims);
                                $("#section-solutions").fadeIn();
                            } else {
                                console.log("handler - No LEAF so QUESTION !");
                                $("form").hide();
                                $("#form-"+current.attr("id")).fadeIn();
                            }
                        });

                        $("form").hide();
                        $("#form-ID1").fadeIn();
                    },
                    error: function(xhr, ajaxOptions, thrownError) {
                        console.log("search ajax error!");
                        console.log(xhr.status);
                        console.log(thrownError);
                    }
                });

                console.log("app initialized...");
            },
            generateFormBloc: function() {
                console.log("generateFormBloc()");
                var self = this;
                var html = '<div class="row">';
                html += '<div class="col-md-12">';
                html += '<div class="card">';
                html += '<div class="card-body quizz">';
                for(var question in this.conf.quizz) {
                    console.log("generateFormBloc()");
                    console.log(question);
                    console.log("generateFormBloc() - question.type:"+self.conf.quizz[question].type);
                    if(self.conf.quizz[question].type == "leaf") {
                        console.log("generateFormBloc() - LEAF !");
                    } else {
                        console.log("generateFormBloc() - No LEAF so QUESTION !");
                        html += self.generateQuestionBloc(question);
                    }
                }
                html += '</div>';
                html += '</div>';
                html += '</div>';
                html += '</div>';
                $("#section-quizz").html(html);
            },
            generateQuestionBloc: function(quizzID) {
                console.log('generateQuestionBloc() - ' + quizzID);
                var self = this;
                var question = this.conf.quizz[quizzID];

                var html = '<form id="form-' + quizzID + '" class="needs-validation">';
                html += '<h1 class="mb-3">' + question.question + '</h1>';
                for(var i = 0; i < question.answers.length; i++) {
                    var id = 'ID' + question.answers[i].goto + '';
                    html += '<div class="form-check">';
                    html += '<input class="form-check-input" type="radio" name="' + question.answers[i].goto + '" id="' + id + '" value="' + question.answers[i].answer + '">';
                    html += '<label class="form-check-label" for="' + id + '">';
                    html += '' + question.answers[i].answer + '';
                    html += '</label>';
                    html += '</div>';
                    console.log('generateQuestionBloc: #ID:' + id);
                }
                html += '</form>';
                return html;
            },
            generateVendorSolutionBloc: function(apim) {
                var html = '<div class="col-md-4">';
                html += '<div class="card">';
                html += '<img class="card-img-top card-header" src="' + apim.image + '" alt="' + apim.name + '">';
                html += '<div class="card-body">';
                html += '<h5 class="card-title">' + apim.name + '</h5>';
                html += '<p class="card-text">' + apim.description + '</p>';
                if(apim.website) {
                    html += '<a href="#" class="btn btn-primary"><span class="oi oi-external-link" title="icon name" aria-hidden="true"></span> ' + apim.website + '</a>';
                }
                html += '</div>';
                if(apim.nb_stars) {
                    html += '<div class="card-footer">';
                    for(var i = 0; i < apim.nb_stars; i++) {
                        html += '<span class="oi oi-star text-success" title="icon name" aria-hidden="true"></span>';
                    }
                    if(apim.nb_stars < 5) {
                        for(var i = apim.nb_stars; i < 5; i++) {
                            html += '<span class="oi oi-star text-black-50" title="icon name" aria-hidden="true"></span>';
                        }
                    }
                    html += '</div>';
                }
                html += '</div>';
                html += '</div>';
                return html;
            }
        }

        var app = OCTO_APIM_APP.app || new OCTO_APIM_APP.app();
        app.init();

    });
</script>


</body>
</html>
